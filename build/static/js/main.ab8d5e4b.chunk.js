(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,n){e.exports=n(30)},24:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"getProducts",function(){return q}),n.d(r,"setCategories",function(){return $}),n.d(r,"setDates",function(){return R});var a={};n.r(a),n.d(a,"setProduct",function(){return _}),n.d(a,"setCategory",function(){return B}),n.d(a,"setQuantity",function(){return L}),n.d(a,"setUnity",function(){return Q}),n.d(a,"setPrice",function(){return F}),n.d(a,"save",function(){return Y});var c=n(0),o=n.n(c),u=n(11),i=n.n(u),s=(n(24),n(2)),l=n(3),p=n(6),d=n(4),f=n(7),m=n(5),h=n(1),g="current:save",v="current:saveSuccess",y="current:saveError",b="current:setName",j="current:setProduct",O="current:setCategory",E="current:setQuantity",w="current:setUnity",C="current:setPrice",k="products:setDates",P="products:setCategories",N="products:getProducts",D="products:getProductsSuccess",S="products:getProductsError",A="http://localhost:8080",I=fetch("".concat(A,"/getProducts/")).then(function(e){return!1}).catch(function(e){return!0}),W=function(e){var t=new Date(e),n=(t.getMonth()+1).toString();n=(1===n.length?"0":"")+n;var r=t.getDate().toString();r=(1===r.length?"0":"")+r;var a=t.getFullYear();return"".concat(a,"-").concat(n,"-").concat(r)},J=function(e,t){var n={},r=e.split("-");return"end"===t&&(r=r.concat(["23:59:59"])),n[t]=1*new Date(r),n},M=function(e,t){return Math.floor(100*e/t)},T=function(e){return e.reduce(function(t,n){var r={name:n.category,spent:0};if(!t.find(function(e){return e.name===r.name})){var a=e.filter(function(e){return e.category===r.name});r.spent=a.reduce(function(e,t){return e+t.price},0),r.subitems=a,r.date=r.subitems[0].date,t.push(r)}return t},[])},U=function(){var e=new Date;return e.setMonth(e.getMonth()-1),1*e}(),x=J(W(1*new Date),"end").end;function q(){return function(e){e({type:N}),function(){if(I){var e=JSON.parse(localStorage.getItem("products")||"[]");return new Promise(function(t,n){return t({data:e})})}var t="".concat(A,"/getProducts/");return fetch(t).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})}().then(function(t){var n,r;t.error?e((n=t.error,{type:S,payload:{error:n}})):(e((r=t.data,{type:D,payload:{products:r}})),e($()))})}}function $(){return function(e,t){var n=t().products.listAll,r=t().products.dates,a=r.ini,c=r.end;n=a&&c?n.filter(function(e){return e.date>=a&&e.date<=c}):n;var o=T(n);e({type:P,payload:{categories:o}})}}function R(e){return{type:k,payload:{dates:e}}}function _(e){return function(t,n){var r=n().products.listAll.find(function(t){return t.name===e});t(r?{type:j,payload:{product:r}}:{type:b,payload:{name:e}})}}function B(e){return function(t){t({type:O,payload:{category:e}})}}function L(e){return function(t){t({type:E,payload:{quantity:e.trim()}})}}function Q(e){return function(t){t({type:w,payload:{unity:e}})}}function F(e){return e=1*e.trim().replace(",","."),e=isNaN(e)?0:e,function(t){t({type:C,payload:{price:e}})}}function Y(){return function(e,t){e({type:g}),function(e){if(e=Object(h.a)({},e,{date:1*new Date}),I){var t=JSON.parse(localStorage.getItem("products")||"[]");return t.push(e),localStorage.setItem("products",JSON.stringify(t)),new Promise(function(e,n){return e({data:t})})}var n="".concat(A,"/save");return fetch(n,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify({product:e})}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(e){return{data:e}}).catch(function(e){return{error:e}})}(t().current).then(function(t){t.error?e((t.error,{type:y})):(e({type:v}),e(q()))})}}n(29);var z=function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.focus&&this._input.focus()}},{key:"componentDidUpdate",value:function(){this.props.focus&&this._input.focus()}},{key:"render",value:function(){var e=this,t=this.props,n=t.items,r=t.current,a=t.placeholder,c=t.setItem,u=n.find(function(e){return e.name===r}),i=!r||u?[]:n.sort(function(e,t){return e-t}).reduce(function(e,t){return e.find(function(e){return e.name===t.name})||e.push(t),e},[]).filter(function(e){return e.name.includes(r)});return o.a.createElement("div",{className:"search"},o.a.createElement("input",{ref:function(t){return e._input=t},type:"text",value:r,placeholder:a,onChange:function(e){c(e.target.value)}}),o.a.createElement("ul",null,i.map(function(e){return o.a.createElement("li",{key:e.date},o.a.createElement("button",{onClick:function(){return c(e.name)}},e.name))})))}}]),t}(c.Component),G=function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.products,n=e.current,r=e.setProduct,a=e.error;return o.a.createElement("div",{className:"product-input"},o.a.createElement("label",null,o.a.createElement(z,{items:t,placeholder:"Enter product",current:n,focus:!0,setItem:r})),o.a.createElement("p",null,a))}}]),t}(c.Component),H=Object(m.b)(function(e){return{products:e.products.listAll,current:e.current.name}},function(e){return{setProduct:function(t){return e(a.setProduct(t))}}})(G),K=function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.categories,n=e.current,r=e.setCategory,a=e.error;return o.a.createElement("div",{className:"category-input"},o.a.createElement("label",null,o.a.createElement(z,{items:t,placeholder:"Enter category",current:n,setItem:r})),o.a.createElement("p",null,a))}}]),t}(c.Component),V=Object(m.b)(function(e){return{categories:e.products.categories,current:e.current.category}},function(e){return{setCategory:function(t){return e(a.setCategory(t))}}})(K),X=function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"price-input"},o.a.createElement("label",null,o.a.createElement("input",{value:this.props.current,placeholder:"Enter price. Ej.: 200",onChange:function(t){return e.props.setPrice(t.target.value)}})),o.a.createElement("p",null,this.props.error))}}]),t}(c.Component),Z=Object(m.b)(function(e){return{current:e.current.price}},function(e){return{setPrice:function(t){return e(a.setPrice(t))}}})(X),ee=function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.categories.reduce(function(e,t){return e+t.spent},0),n=this.props.dates,r=n.ini,a=n.end;r=W(r),a=W(a);var c=function(t,n){var r=J(t,n);e.props.setDates(r),e.props.setCategories()};return o.a.createElement("section",{className:"graphdata-input"},o.a.createElement("h2",null,"$ ",this.props.categories.reduce(function(e,t){return e+t.spent},0)),o.a.createElement("label",null,o.a.createElement("input",{type:"date",value:r,onChange:function(e){return c(e.target.value,"ini")}})),o.a.createElement("label",null,o.a.createElement("input",{type:"date",value:a,onChange:function(e){return c(e.target.value,"end")}})),o.a.createElement("p",null,this.props.error),o.a.createElement("div",{className:"catlist"},this.props.categories.sort(function(e,t){return t.spent-e.spent}).map(function(e){var n=e.subitems.reduce(function(e,t){return e+t.price},0);return o.a.createElement("div",{key:e.name},o.a.createElement("p",null,o.a.createElement("span",{className:"catname"},e.name,": "),o.a.createElement("span",{className:"perc"},M(e.spent,t)," %"),o.a.createElement("span",{className:"price"},"$ ",e.spent)),o.a.createElement("ul",null,e.subitems.map(function(e){return o.a.createElement("li",{key:e.date},o.a.createElement("span",null,e.name),o.a.createElement("span",{className:"perc"},M(e.price,n)," %"),o.a.createElement("span",{className:"price"},"\xa0$ ",e.price),o.a.createElement("span",{className:"pdate"},"| ",W(e.date)," |"))})))})))}}]),t}(c.Component),te=Object(m.b)(function(e){return{dates:e.products.dates,categories:e.products.categories,products:e.products.listAll}},function(e){return{setCategories:function(){return e(r.setCategories())},setDates:function(t){return e(r.setDates(t))}}})(ee),ne=function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.getProducts(),document.title="Control money spending"}},{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement("h1",null,"CtrlCom"),o.a.createElement("section",null,o.a.createElement(H,null),o.a.createElement(V,null),o.a.createElement(Z,null),o.a.createElement("button",{onClick:this.props.save},"Done")),o.a.createElement(te,null))}}]),t}(c.Component),re=Object(m.b)(function(e){return e},function(e){return{getProducts:function(){return e(r.getProducts())},save:function(){return e(a.save())}}})(ne),ae=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ce(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var oe=n(18),ue=n(9),ie={dates:{ini:U,end:x},categories:[],listAll:[],error:null,loading:!1};var se={name:"",category:"",quantity:"",unity:"",price:"",date:1*new Date};var le=Object(ue.c)({products:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case N:return Object(h.a)({},e,{loading:!0,error:null});case D:return Object(h.a)({},e,{listAll:r.products,loading:!1,error:null});case S:return Object(h.a)({},e,{loading:!1,error:r.error});case P:return Object(h.a)({},e,{categories:r.categories});case k:return Object(h.a)({},e,{dates:Object(h.a)({},e.dates,r.dates)});default:return e}},current:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case j:return Object(h.a)({},e,r.product);case b:return Object(h.a)({},e,{name:r.name});case O:return Object(h.a)({},e,{category:r.category});case E:return Object(h.a)({},e,{quantity:r.quantity});case w:return Object(h.a)({},e,{unity:r.unity});case C:return Object(h.a)({},e,{price:r.price});case g:return Object(h.a)({},e);case v:return Object(h.a)({},se,{date:1*new Date});case y:return Object(h.a)({},e);default:return e}}}),pe=Object(ue.d)(Object(ue.a)(oe.a)),de=Object(ue.e)(le,pe);i.a.render(o.a.createElement(m.a,{store:de},o.a.createElement(re,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");ae?(function(e,t){fetch(e).then(function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ce(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):ce(t,e)})}}()}},[[19,1,2]]]);
//# sourceMappingURL=main.ab8d5e4b.chunk.js.map